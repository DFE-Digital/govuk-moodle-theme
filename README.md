# GOV.UK Moodle Theme

A GOV.UK Moodle theme implementing [GOV GDS](https://design-system.service.gov.uk/).

# Theme distribution

## Versioning

The [semantic versioning](https://semver.org/) standard will be implemented once the theme is sufficiently developed and relatively stable:

"Given a version number MAJOR.MINOR.PATCH, increment the

1. MAJOR version when you make incompatible API changes
2. MINOR version when you add functionality in a backward compatible manner
3. PATCH version when you make backward compatible bug fixes

Additional labels for pre-release and build metadata are available as extensions to the MAJOR.MINOR.PATCH format."

## Creating a release

The release.yml GitHub workflow should be used to create a release. To run the workflow, trigger it manually via the GitHub Actions UI and provide the version number as input, in the suggested format "[MAJOR].[MINOR].[PATCH]".
The workflow tags the latest commit on the main branch, archives the contents of the `govuk` folder, and creates a release which includes the created archive alongside the assets generated by default with a release. Release notes are auto-generated. Lightweight tags are used.

## Including the theme as part of Moodle

### Manual setup

To use this theme you need to copy the `govuk` directory from a release archive into your Moodle site's theme folder `\my-moodle-site\public\theme`. Moodle will then detect the added theme when started. You will need to confirm the installation. Once installed you will be able to select the `GOV.UK` theme from the theme selection page.

Please use the assets available as part of the existing versioned releases or create a new release.

### Automated setup

To use this theme as part of your Moodle deployment scripts, the download of the release archive must be automated as well as the steps described in the manual approach.

It is the responsibility of those using this theme to check regularly for updates and to implement new versions as required.

## Local Development

If this is the first time you are generating the CSS file locally, navigate to the `govuk` folder in the theme repo and run:

```bash
npm install
```

### ðŸ›  Making Changes

After you've made changes to your local instance of Moodle, you'll likely want to:

1. **Compile the SCSS into CSS**
2. **Copy updated theme files into your local Moodle instance**

#### 1. Compile SCSS

To compile the SCSS into CSS, run:

```bash
npm run build
```

This compiles the `govuk.scss` file from the `scss` folder and outputs it to `style/govuk.css`. The CSS must be placed in the `style` folder for Moodle to correctly reference it. It also copies the images from the `govuk-frontend` into the `pix` directory for use within Moodle.

To compile a compressed production build:

```bash
npm run build:prod
```

#### 2. Copy Theme Files to Moodle

To copy the updated theme files (`style/`, `templates/`, and `pix/`) into your local Moodle environment, use the `copy:theme` script:

```bash
npm run copy:theme -- /full/path/to/moodle/theme/govuk
```

You can also add:

* `--watch` to automatically copy changes as you edit files
* `--verbose` to log every copied file

Example:

```bash
npm run copy:theme -- /home/username/moodle-ddev/public/theme/govuk --watch --verbose
```

---

### ðŸ”§ Full Dev Workflow

You can run a full development workflow with live watching by setting the `MOODLE_THEME_PATH` environment variable and using:

```bash
npm run dev
```

This will:

* Watch all SCSS files and automatically rebuild the CSS
* Copy updated theme files to Moodle as they change

To avoid typing your Moodle path every time, create a `.env` file in the root of the project:

```env
MOODLE_THEME_PATH=/home/username/moodle-ddev/public/theme/govuk
```

> Note: `~` is **not supported** in `.env` paths. Use the full path to your home directory (e.g., `/home/username/...`)

Then just run:

```bash
npm run dev
```

a `.env.example` file you can update has been included in the repo. Copy it to `.env` by running:

```bash
cp .env.example .env
```


